'use strict';

const { send, handleRateLimit } = require('../../helpers');
const Handler = require('../../structures/pieces/Handler');

const caption =
  '–î–æ –ó–ù–û –∑–∞–ª–∏—à–∏–ª–æ—Å—å –º–µ–Ω—à–µ 3-—Ö –º—ñ—Å—è—Ü—ñ–≤üòÆ\n' +
  '–ù–µ –ø–∞–Ω—ñ–∫—É–π, –∞ –∫—Ä–∞—â–µ –ª–æ–≤–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π —à–∞–Ω—Å –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ ' +
  '–ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏—Å—å –¥–æ —Ç–µ—Å—Ç—ñ–≤ —Ç–∞ –Ω–∞–≤–µ—Å—Ç–∏ –ø–æ—Ä—è–¥–æ–∫ –≤ —Å–≤–æ—ó—Ö –∑–Ω–∞–Ω–Ω—è—Ö!\n' +
  '<b>–°–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±–µ –∫–æ–º–∞–Ω–¥–∞ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤ –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä—É "Cactus"' +
  '—Ä–æ–∑—Ä–æ–±–∏–ª–∞ –µ–∫—Å–ø—Ä–µ—Å-–∫—É—Ä—Å –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–æ –ó–ù–û 2021 –∑ —É—Å—ñ—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø—Ä–µ–¥–º–µ—Ç—ñ–≤.</b>\n' +
  'üë®üèª‚Äçüè´–§–æ—Ä–º–∞—Ç –Ω–∞–≤—á–∞–Ω–Ω—è: –û–Ω–ª–∞–π–Ω –∞–±–æ –æ—Ñ—Ñ–ª–∞–π–Ω (–ö–∏—ó–≤).\n' +
  'üë•–ú—ñ–Ω—ñ-–≥—Ä—É–ø–∏ (3-7 —É—á–Ω—ñ–≤).\n' +
  'üèÖ–í–∏–∫–ª–∞–¥–∞—á—ñ-–ø—Ä–∞–∫—Ç–∏–∫–∏ —ñ–∑ –≤–ª–∞—Å–Ω–∏–º –±–∞–ª–æ–º –ó–ù–û 195+.\n' +
  'üíª–ó–∞–∫—Ä–∏—Ç–∏–π —á–∞—Ç –≤ —Ç–µ–ª–µ–≥—Ä–∞–º—ñ.\n' +
  'üë©üèº‚Äçüíª–û–Ω–ª–∞–π–Ω-–ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤ 24/7.\n' +
  'üéØ–ñ–æ–¥–Ω–æ—ó "–≤–æ–¥–∏", –ª–∏—à–µ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞—Ü—ñ–ª–µ–Ω–∞ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.\n' +
  '‚è±4.5 –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏—Ö –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –≥–æ–¥–∏–Ω –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.\n' +
  'üíµ–ê–¥–µ–∫–≤–∞—Ç–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å.\n' +
  '–°—É–º–Ω—ñ–≤–∞—î—à—Å—è –≤ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≤—Å—Ç—ñ –Ω–∞—à–∏—Ö –∫—É—Ä—Å—ñ–≤?\n' +
  '<b>–°–ø—Ä–æ–±—É–π –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–µ –∑–∞–Ω—è—Ç—Ç—è, —è–∫–µ –ø–µ—Ä–µ–≤–µ—Ä–Ω–µ —Ç–≤–æ—é —É—è–≤—É –ø—Ä–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É –¥–æ –ó–ù–û.</b>\n' +
  '–î–ª—è –∑–∞–ø–∏—Å—É –Ω–∞ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–µ –∑–∞–Ω—è—Ç—Ç—è —Ç–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó —Ç–µ–ª–µ—Ñ–æ–Ω—É–π: 067 68 55 732\n' +
  '(telegram, viber) –∞–±–æ –∑–∞–ª–∏—à–∞–π –∑–∞—è–≤–∫—É –Ω–∞ –æ–¥–Ω–æ–º—É –∑ –Ω–∞—à–∏—Ö —Å–∞–π—Ç—ñ–≤:\n' +
  '- cactuszno.com.ua/intensivecourse - –æ—Ñ—Ñ–ª–∞–π–Ω –∫—É—Ä—Å–∏ –≤ –ö–∏—î–≤—ñ;\n' +
  '- cactuszno.com.ua/onlinecourse - –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å–∏.';

const sendMessage = (ctx, id) =>
  ctx.telegram
    .sendPhoto(id, 'https://i.imgur.com/oiH1HND.jpeg', {
      caption,
      parse_mode: 'HTML',
      reply_markup: {
        inline_keyboard: [[{ text: '–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–∞–Ω–∞–ª—É CactusZNO', url: 'https://t.me/cactus_zno' }]],
      },
    })
    // eslint-disable-next-line no-empty-function
    .catch(err => {
      if (err.code === 429) handleRateLimit(ctx, err);
      console.error('–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ');
    });

module.exports = class extends Handler {
  constructor(...args) {
    super(...args, {
      name: 'test',
      types: ['command', 'action'],
    });
  }

  async run(ctx, userID) {
    if (!userID || ![546886852, 409482221].includes(ctx.from.id)) return;

    let success = 0;
    for await (const user of ctx.users) {
      await sendMessage(ctx, user.id);
      console.log('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ', user.id);
      success += 1;
    }
    send(ctx, `–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ ${success} —Å–æ–æ–±—â–µ–Ω–∏–π`);
  }
};
